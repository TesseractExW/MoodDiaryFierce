@page "/dashboard/graph"
@attribute [Authorize]
@using Microsoft.AspNetCore.Authorization
@using MoodDiaryFierce.Models.Databases
@inject UserManagerService UserManager
@inject NavigationManager Navigation
<PageTitle>Dashboard Graph</PageTitle>

<SfChart Title="Mood Trends Over Time">
    <ChartPrimaryXAxis ValueType="Syncfusion.Blazor.Charts.ValueType.DateTime" LabelFormat="dd/MM" Title="Date"></ChartPrimaryXAxis>
    <ChartPrimaryYAxis Title="Mood Level"></ChartPrimaryYAxis>

    <ChartSeriesCollection>
        <ChartSeries DataSource="@moods"
                    XName="Time"
                    YName="Happiness"
                    Type="ChartSeriesType.StackingLine">
                    <ChartMarker Visible="true"></ChartMarker>
        </ChartSeries>
    </ChartSeriesCollection>
</SfChart>

<AuthorizeView>
    <NotAuthorized>
        @{
            Navigation.NavigateTo("/login", forceLoad: true);
        }
    </NotAuthorized>
</AuthorizeView>
@code {
    List<MoodModel>? moods;
    protected override async Task OnInitializedAsync()
    {
        moods = await UserManager.GetMoodsAsync();
    }
}